setwd("~/00_dsc/kschool_master_data_science/Master-in-Data-Science/sessions/R")
library(tm)
# cargamos los datos que hemos bajado de internet usando thyssen_scraping.R
# se trata de las descripciones de los cuadros del mueseo en cuestiÃƒÂ³n
load("thyssen.Rdata")     # carga thyssen
# comentarios contiene blablablÃƒÂ¡ sobre los cuadros
# los metadatos contienen el autor, el tÃƒ­tulo y la fecha
comentarios <- sapply(thyssen, function(x) x$texto)
metadatos   <- lapply(thyssen, function(x) x$ficha)
length(comentarios)
hist(nchar(comentarios))
## CreaciÃƒÂ³n de un "corpus"
comentarios <- VCorpus(VectorSource(comentarios), readerControl = list(language = "es"))
# VCorpus tiene otras "sources": directorios, etc.
# en tm, para "ver" objetos, se usa inspect:
inspect(comentarios[1:3])
# Un Corpus es una lista de documentos; cada documento tiene el texto y
# un conjunto de metadatos (que no usaremos)
str(comentarios[1])
comentarios[[1]]$content
## transformaciones: tm_map aplica una funciÃƒÂ³n a cada documento
comentarios <- tm_map(comentarios, stripWhitespace)
comentarios <- tm_map(comentarios, content_transformer(tolower))
comentarios <- tm_map(comentarios, removeWords, stopwords("spanish"))
# wordcloud: sigue las instrucciones de https://georeferenced.wordpress.com/2013/01/15/rwordcloud/
# y crea una. Ten cuidado con max.words (comienza conservadoramente).
## Â¿lematizaciÃ³n? (cuidado: es lenta)
prueba <- tm_map(comentarios[1:10], stemDocument)
prueba[[1]]$content
# ejercicio: haz un wordcloud de prueba
## Matrices de palabras
dcm.thyssen <- DocumentTermMatrix(comentarios)
# filtra los tÃ©rminos "sparse": que aparecen en pocos documentos
dcm.thyssen.small <- removeSparseTerms(dcm.thyssen, sparse= 0.8)
install.packages("SnowballC")
prueba <- tm_map(comentarios[1:10], stemDocument)
prueba[[1]]$content
# ejercicio: haz un wordcloud de prueba
## Matrices de palabras
dcm.thyssen <- DocumentTermMatrix(comentarios)
# filtra los tÃ©rminos "sparse": que aparecen en pocos documentos
dcm.thyssen.small <- removeSparseTerms(dcm.thyssen, sparse= 0.8)
inspect(dcm.thyssen.small[1:10, 1:10])
findFreqTerms(dcm.thyssen, 100)
# nota: aparecen comas... Â¡hay que volver atrÃ¡s y quitarlas! Â¿CÃ³mo?
findAssocs(dcm.thyssen, "dalÃ­", 0.6)
findAssocs(dcm.thyssen, "barroco", 0.5)
findAssocs(dcm.thyssen, "cubista", 0.6)
findAssocs(dcm.thyssen, "beaulieu", 0.6)
dcm.thyssen
dcm.thyssen.small
inspect(dcm.thyssen.small[1:10, 1:10])
findFreqTerms(dcm.thyssen, 100)
findFreqTerms(dcm.thyssen, 10)
findFreqTerms(dcm.thyssen, 1000)
findFreqTerms(dcm.thyssen, 10000)
findFreqTerms(dcm.thyssen, 5000)
findFreqTerms(dcm.thyssen, 2000)
findFreqTerms(dcm.thyssen, 1500)
findFreqTerms(dcm.thyssen, 100)
findFreqTerms(dcm.thyssen, 1500)
findFreqTerms(dcm.thyssen, 1000)
findFreqTerms(dcm.thyssen, 1200)
findFreqTerms(dcm.thyssen, 100)
dcm.norm <- weightTfIdf(dcm.thyssen)
dcm.norm
inspect(dcm.norm)
inspect(dcm.norm).head()
inspect(dcm.norm)[1:10,1:10]
fechas <- sapply(metadatos, function(x) x[3])
fechas <- as.numeric(fechas)
dat <- data.frame(fecha = fechas, res)
dat <- dat[!is.na(dat$fecha),]
library(party)
modelo <- ctree(fecha ~ ., data = dat)
plot(modelo)
res <- as.data.frame(inspect(dcm.thyssen.small))
# vamos a tratar de predecir la fecha de un cuadro segÃºn las palabras con que se describe
fechas <- sapply(metadatos, function(x) x[3])
fechas <- as.numeric(fechas)
dat <- data.frame(fecha = fechas, res)
dat <- dat[!is.na(dat$fecha),]
library(party)
modelo <- ctree(fecha ~ ., data = dat)
plot(modelo)
library(topicmodels)
install.packages("topicmodels")
library(topicmodels)
burnin <- 4000
thin <- 500
iter <- 2000
seed <-list(2003,5,63,100001,765)
nstart <- 5
best <- TRUE
k <- 5
freqs <- apply(dcm.thyssen.small, 1, sum)
m     <- dcm.thyssen.small[freqs > 0, ]
ldaOut <-LDA(m, k, method="Gibbs",
control=list(nstart=nstart, seed = seed, best=best,
burnin = burnin, iter = iter, thin=thin))
topics(ldaOut)
ncols(ldaOut)
str(ldaOut)
wordassignments(ldaOut)
terms(ldaOut)
woedassignment(ldaOut)
wordassignment(ldaOut)
wordassignments(ldaOut)
wordassignments(ldaOut)
install.packages("NMF")
m <- as.matrix(m)
library(NMF)
m <- as.matrix(m)
res <- nmf(m, 5)
basismap(res)
coefmap(res)
install.packages("revealjs")
install.packages("worldcloud")
library(wordcloud)
library(worldcloud)
install.packages("wordcloud")
wordcloud(comentarios,scale=(5,0.5),max.words=200,random.order=FALSE, rot.per=0.35, use.r.layout=FALSE, colors=brewer.pal(8, â€œDark2â€)))
wordcloud(comentarios,scale=c(5,0.5), max.words=100, random.order=FALSE, rot.per=0.35, use.r.layout=FALSE, colors=brewer.pal(8, â€œDark2â€))
wordcloud(comentarios, scale=c(5,0.5), max.words=100, random.order=FALSE, rot.per=0.35, use.r.layout=FALSE, colors=brewer.pal(8, â€œDark2â€))
wordcloud(comentarios, scale=c(5,0.5), max.words=100, random.order=FALSE, rot.per=0.35, use.r.layout=FALSE, colors=brewer.pal(8, Dark2))
library(worldcloud)
library(wordcloud)
wordcloud(comentarios, scale=c(5,0.5), max.words=100, random.order=FALSE, rot.per=0.35, use.r.layout=FALSE, colors=brewer.pal(8, Dark2))
wordcloud(comentarios, scale=c(5,0.5), max.words=100, random.order=FALSE, rot.per=0.35, use.r.layout=FALSE, colors=brewer.pal(8, "Dark2"))
wordcloud(comentarios, scale=c(5,0.5), max.words=10, random.order=FALSE, rot.per=0.35, use.r.layout=FALSE, colors=brewer.pal(8, "Dark2"))
wordcloud(comentarios, scale=c(5,0.5), max.words=50, random.order=FALSE, rot.per=0.35, use.r.layout=FALSE, colors=brewer.pal(8, "Dark2"))
wordcloud(comentarios, scale=c(5,0.5), max.words=50, random.order=FALSE, rot.per=0.75, use.r.layout=FALSE, colors=brewer.pal(8, "Dark2"))
wordcloud(comentarios, scale=c(5,0.5), max.words=50, random.order=FALSE, rot.per=0.0, use.r.layout=FALSE, colors=brewer.pal(8, "Dark2"))
wordcloud(comentarios, scale=c(5,0.5), max.words=50, random.order=FALSE, rot.per=0.25, use.r.layout=FALSE, colors=brewer.pal(8, "Dark2"))
wordcloud(comentarios, scale=c(5,0.5), max.words=50, random.order=FALSE, rot.per=0.25, use.r.layout=FALSE, colors=brewer.pal(6, "Dark2"))
wordcloud(comentarios, scale=c(5,0.5), max.words=50, random.order=FALSE, rot.per=0.25, use.r.layout=FALSE, colors=brewer.pal(1, "Dark2"))
wordcloud(comentarios, scale=c(5,0.5), max.words=50, random.order=FALSE, rot.per=0.25, use.r.layout=FALSE, colors=brewer.pal(1, "Dark"))
wordcloud(comentarios, scale=c(5,0.5), max.words=50, random.order=FALSE, rot.per=0.25, use.r.layout=FALSE, colors=brewer.pal(1, "Dark1"))
wordcloud(comentarios, scale=c(5,0.5), max.words=50, random.order=FALSE, rot.per=0.25, use.r.layout=FALSE, colors=brewer.pal(1, "Dark2"))
